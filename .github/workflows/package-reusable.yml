name: Package Phase - Reusable Workflow

on:
  workflow_call:
    inputs:
      build-version:
        description: "Build version to use for packaging"
        required: true
        type: string
    outputs:
      package-version:
        description: "Version of the packaged application"
        value: ${{ jobs.package-application.outputs.package-version }}
      package-size:
        description: "Size of the packaged application"
        value: ${{ jobs.package-application.outputs.package-size }}

jobs:
  package-application:
    name: Package Application
    runs-on: ubuntu-latest
    outputs:
      package-version: ${{ steps.package.outputs.version }}
      package-size: ${{ steps.package.outputs.size }}
    steps:
      - name: Package application
        id: package
        run: |
          echo "ğŸ“¦ Packaging application"
          echo "ğŸ—ï¸  Creating deployment package"
          sleep 3
          echo "ğŸ—œï¸  Compressing assets"
          sleep 2
          echo "ğŸ“ Generating deployment manifest"
          sleep 1

          PACKAGE_VERSION="${{ inputs.build-version }}"
          PACKAGE_SIZE="127.5 MB"

          echo "ğŸ“¦ Package created successfully"
          echo "   Version: $PACKAGE_VERSION"
          echo "   Size: $PACKAGE_SIZE"
          echo "version=$PACKAGE_VERSION" >> $GITHUB_OUTPUT
          echo "size=$PACKAGE_SIZE" >> $GITHUB_OUTPUT
          echo "âœ… Application packaged"

  generate-documentation:
    name: Generate Documentation
    runs-on: ubuntu-latest
    steps:
      - name: Generate API documentation
        run: |
          echo "ğŸ“š Generating API documentation"
          echo "ğŸ“ Extracting API definitions"
          sleep 2
          echo "ğŸ“ Generating OpenAPI specs"
          sleep 2
          echo "ğŸ“ Creating developer guides"
          sleep 2
          echo "âœ… Documentation generated"

      - name: Generate deployment docs
        run: |
          echo "ğŸ“‹ Generating deployment documentation"
          echo "ğŸ“ Creating deployment guides"
          sleep 1
          echo "ğŸ“ Generating configuration templates"
          sleep 1
          echo "âœ… Deployment documentation ready"

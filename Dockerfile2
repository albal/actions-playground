FROM mcr.microsoft.com/windows/servercore:ltsc2022

WORKDIR /src
ARG USER
ARG PASSWORD
ENV PAT_USER=$USER
ENV PAT_PASSWORD=$PASSWORD

COPY ["nuget.config", "nuget.config"]
RUN powershell -Command "(Get-Content nuget.config).Replace('PAT_USER', $env:PAT_USER) | Set-Content nuget.config"
RUN powershell -Command "(Get-Content nuget.config).Replace('PAT_PASSWORD', $env:PAT_PASSWORD) | Set-Content nuget.config"
RUN type nuget.config
